{"version":3,"file":"use-map-control.js","names":["useContext","useRef","useEffect","PropTypes","MapContext","mapControlDefaultProps","captureScroll","captureDrag","captureClick","captureDoubleClick","capturePointerMove","mapControlPropTypes","bool","onMount","thisRef","ref","containerRef","current","eventManager","context","undefined","events","wheel","evt","props","stopPropagation","onScroll","panstart","onDragStart","anyclick","onClick","click","dblclick","onDoubleClick","pointermove","onPointerMove","watch","off","useMapControl","_thisRef","state"],"sources":["../../../src/components/use-map-control.js"],"sourcesContent":["import {useContext, useRef, useEffect} from 'react';\nimport * as PropTypes from 'prop-types';\nimport MapContext from './map-context';\n\nexport const mapControlDefaultProps = {\n  captureScroll: false,\n  captureDrag: true,\n  captureClick: true,\n  captureDoubleClick: true,\n  capturePointerMove: false\n};\n\nexport const mapControlPropTypes = {\n  /** Event handling */\n  captureScroll: PropTypes.bool,\n  // Stop map pan & rotate\n  captureDrag: PropTypes.bool,\n  // Stop map click\n  captureClick: PropTypes.bool,\n  // Stop map double click\n  captureDoubleClick: PropTypes.bool,\n  // Stop map pointer move\n  capturePointerMove: PropTypes.bool\n};\n\nfunction onMount(thisRef) {\n  const ref = thisRef.containerRef.current;\n  const {eventManager} = thisRef.context;\n  if (!ref || !eventManager) {\n    return undefined;\n  }\n\n  const events = {\n    wheel: evt => {\n      const {props} = thisRef;\n      if (props.captureScroll) {\n        evt.stopPropagation();\n      }\n      if (props.onScroll) {\n        props.onScroll(evt, thisRef);\n      }\n    },\n    panstart: evt => {\n      const {props} = thisRef;\n      if (props.captureDrag) {\n        evt.stopPropagation();\n      }\n      if (props.onDragStart) {\n        props.onDragStart(evt, thisRef);\n      }\n    },\n    anyclick: evt => {\n      const {props} = thisRef;\n      if (props.captureClick) {\n        evt.stopPropagation();\n      }\n      if (props.onClick) {\n        props.onClick(evt, thisRef);\n      }\n    },\n    click: evt => {\n      const {props} = thisRef;\n      if (props.captureClick) {\n        evt.stopPropagation();\n      }\n      if (props.onClick) {\n        props.onClick(evt, thisRef);\n      }\n    },\n    dblclick: evt => {\n      const {props} = thisRef;\n      if (props.captureDoubleClick) {\n        evt.stopPropagation();\n      }\n      if (props.onDoubleClick) {\n        props.onDoubleClick(evt, thisRef);\n      }\n    },\n    pointermove: evt => {\n      const {props} = thisRef;\n      if (props.capturePointerMove) {\n        evt.stopPropagation();\n      }\n      if (props.onPointerMove) {\n        props.onPointerMove(evt, thisRef);\n      }\n    }\n  };\n  eventManager.watch(events, ref);\n\n  // Clean up\n  return () => {\n    eventManager.off(events);\n  };\n}\n\nexport default function useMapControl(props = {}) {\n  const context = useContext(MapContext);\n  const containerRef = useRef(null);\n  const _thisRef = useRef({props, state: {}, context, containerRef});\n  const thisRef = _thisRef.current;\n\n  thisRef.props = props;\n  thisRef.context = context;\n\n  useEffect(() => onMount(thisRef), [context.eventManager]);\n\n  return thisRef;\n}\n"],"mappings":"AAAA,SAAQA,UAAU,EAAEC,MAAM,EAAEC,SAAS,QAAO,OAAO;AACnD,OAAO,KAAKC,SAAS,MAAM,YAAY;AACvC,OAAOC,UAAU,MAAM,eAAe;AAEtC,OAAO,IAAMC,sBAAsB,GAAG;EACpCC,aAAa,EAAE,KAAK;EACpBC,WAAW,EAAE,IAAI;EACjBC,YAAY,EAAE,IAAI;EAClBC,kBAAkB,EAAE,IAAI;EACxBC,kBAAkB,EAAE;AACtB,CAAC;AAED,OAAO,IAAMC,mBAAmB,GAAG;EAEjCL,aAAa,EAAEH,SAAS,CAACS,IAAI;EAE7BL,WAAW,EAAEJ,SAAS,CAACS,IAAI;EAE3BJ,YAAY,EAAEL,SAAS,CAACS,IAAI;EAE5BH,kBAAkB,EAAEN,SAAS,CAACS,IAAI;EAElCF,kBAAkB,EAAEP,SAAS,CAACS;AAChC,CAAC;AAED,SAASC,OAAO,CAACC,OAAO,EAAE;EACxB,IAAMC,GAAG,GAAGD,OAAO,CAACE,YAAY,CAACC,OAAO;EACxC,IAAOC,YAAY,GAAIJ,OAAO,CAACK,OAAO,CAA/BD,YAAY;EACnB,IAAI,CAACH,GAAG,IAAI,CAACG,YAAY,EAAE;IACzB,OAAOE,SAAS;EAClB;EAEA,IAAMC,MAAM,GAAG;IACbC,KAAK,EAAE,eAAAC,GAAG,EAAI;MACZ,IAAOC,KAAK,GAAIV,OAAO,CAAhBU,KAAK;MACZ,IAAIA,KAAK,CAAClB,aAAa,EAAE;QACvBiB,GAAG,CAACE,eAAe,EAAE;MACvB;MACA,IAAID,KAAK,CAACE,QAAQ,EAAE;QAClBF,KAAK,CAACE,QAAQ,CAACH,GAAG,EAAET,OAAO,CAAC;MAC9B;IACF,CAAC;IACDa,QAAQ,EAAE,kBAAAJ,GAAG,EAAI;MACf,IAAOC,KAAK,GAAIV,OAAO,CAAhBU,KAAK;MACZ,IAAIA,KAAK,CAACjB,WAAW,EAAE;QACrBgB,GAAG,CAACE,eAAe,EAAE;MACvB;MACA,IAAID,KAAK,CAACI,WAAW,EAAE;QACrBJ,KAAK,CAACI,WAAW,CAACL,GAAG,EAAET,OAAO,CAAC;MACjC;IACF,CAAC;IACDe,QAAQ,EAAE,kBAAAN,GAAG,EAAI;MACf,IAAOC,KAAK,GAAIV,OAAO,CAAhBU,KAAK;MACZ,IAAIA,KAAK,CAAChB,YAAY,EAAE;QACtBe,GAAG,CAACE,eAAe,EAAE;MACvB;MACA,IAAID,KAAK,CAACM,OAAO,EAAE;QACjBN,KAAK,CAACM,OAAO,CAACP,GAAG,EAAET,OAAO,CAAC;MAC7B;IACF,CAAC;IACDiB,KAAK,EAAE,eAAAR,GAAG,EAAI;MACZ,IAAOC,KAAK,GAAIV,OAAO,CAAhBU,KAAK;MACZ,IAAIA,KAAK,CAAChB,YAAY,EAAE;QACtBe,GAAG,CAACE,eAAe,EAAE;MACvB;MACA,IAAID,KAAK,CAACM,OAAO,EAAE;QACjBN,KAAK,CAACM,OAAO,CAACP,GAAG,EAAET,OAAO,CAAC;MAC7B;IACF,CAAC;IACDkB,QAAQ,EAAE,kBAAAT,GAAG,EAAI;MACf,IAAOC,KAAK,GAAIV,OAAO,CAAhBU,KAAK;MACZ,IAAIA,KAAK,CAACf,kBAAkB,EAAE;QAC5Bc,GAAG,CAACE,eAAe,EAAE;MACvB;MACA,IAAID,KAAK,CAACS,aAAa,EAAE;QACvBT,KAAK,CAACS,aAAa,CAACV,GAAG,EAAET,OAAO,CAAC;MACnC;IACF,CAAC;IACDoB,WAAW,EAAE,qBAAAX,GAAG,EAAI;MAClB,IAAOC,KAAK,GAAIV,OAAO,CAAhBU,KAAK;MACZ,IAAIA,KAAK,CAACd,kBAAkB,EAAE;QAC5Ba,GAAG,CAACE,eAAe,EAAE;MACvB;MACA,IAAID,KAAK,CAACW,aAAa,EAAE;QACvBX,KAAK,CAACW,aAAa,CAACZ,GAAG,EAAET,OAAO,CAAC;MACnC;IACF;EACF,CAAC;EACDI,YAAY,CAACkB,KAAK,CAACf,MAAM,EAAEN,GAAG,CAAC;EAG/B,OAAO,YAAM;IACXG,YAAY,CAACmB,GAAG,CAAChB,MAAM,CAAC;EAC1B,CAAC;AACH;AAEA,eAAe,SAASiB,aAAa,GAAa;EAAA,IAAZd,KAAK,uEAAG,CAAC,CAAC;EAC9C,IAAML,OAAO,GAAGnB,UAAU,CAACI,UAAU,CAAC;EACtC,IAAMY,YAAY,GAAGf,MAAM,CAAC,IAAI,CAAC;EACjC,IAAMsC,QAAQ,GAAGtC,MAAM,CAAC;IAACuB,KAAK,EAALA,KAAK;IAAEgB,KAAK,EAAE,CAAC,CAAC;IAAErB,OAAO,EAAPA,OAAO;IAAEH,YAAY,EAAZA;EAAY,CAAC,CAAC;EAClE,IAAMF,OAAO,GAAGyB,QAAQ,CAACtB,OAAO;EAEhCH,OAAO,CAACU,KAAK,GAAGA,KAAK;EACrBV,OAAO,CAACK,OAAO,GAAGA,OAAO;EAEzBjB,SAAS,CAAC;IAAA,OAAMW,OAAO,CAACC,OAAO,CAAC;EAAA,GAAE,CAACK,OAAO,CAACD,YAAY,CAAC,CAAC;EAEzD,OAAOJ,OAAO;AAChB"}