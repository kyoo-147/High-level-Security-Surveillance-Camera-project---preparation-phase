{"version":3,"file":"dynamic-position.js","names":["ANCHOR_POSITION","top","x","y","bottom","left","right","ANCHOR_TYPES","Object","keys","getDynamicPosition","width","height","selfWidth","selfHeight","anchor","padding","anchorX","anchorY","cutoffY","Math","max","bestAnchorY","minCutoff","xStep","floor","cutoffX","bestAnchorX","find","positionType","anchorPosition"],"sources":["../../../src/utils/dynamic-position.js"],"sourcesContent":["export const ANCHOR_POSITION = {\n  top: {x: 0.5, y: 0},\n  'top-left': {x: 0, y: 0},\n  'top-right': {x: 1, y: 0},\n  bottom: {x: 0.5, y: 1},\n  'bottom-left': {x: 0, y: 1},\n  'bottom-right': {x: 1, y: 1},\n  left: {x: 0, y: 0.5},\n  right: {x: 1, y: 0.5}\n};\n\nconst ANCHOR_TYPES = Object.keys(ANCHOR_POSITION);\n\n/**\n * Calculate the dynamic position for a popup to fit in a container.\n * @param {Object} opts\n * @param {Number} opts.x - x position of the anchor on screen\n * @param {Number} opts.y - y position of the anchor on screen\n * @param {Number} opts.width - width of the container\n * @param {Number} opts.height - height of the container\n * @param {Number} opts.padding - extra space from the edge in pixels\n * @param {Number} opts.selfWidth - width of the popup\n * @param {Number} opts.selfHeight - height of the popup\n * @param {String} opts.anchor - type of the anchor, one of 'top', 'bottom',\n    'left', 'right', 'top-left', 'top-right', 'bottom-left' , and  'bottom-right'\n * @returns {String} position - one of 'top', 'bottom',\n    'left', 'right', 'top-left', 'top-right', 'bottom-left' , and  'bottom-right'\n */\n// eslint-disable-next-line complexity,max-statements\nexport function getDynamicPosition({\n  x,\n  y,\n  width,\n  height,\n  selfWidth,\n  selfHeight,\n  anchor,\n  padding = 0\n}) {\n  let {x: anchorX, y: anchorY} = ANCHOR_POSITION[anchor];\n\n  // anchorY: top - 0, center - 0.5, bottom - 1\n  let top = y - anchorY * selfHeight;\n  let bottom = top + selfHeight;\n  let cutoffY = Math.max(0, padding - top) + Math.max(0, bottom - height + padding);\n\n  if (cutoffY > 0) {\n    // Needs vertical adjustment\n    let bestAnchorY = anchorY;\n    let minCutoff = cutoffY;\n    // Test anchorY at 0.5 step between [0, 1]\n    for (anchorY = 0; anchorY <= 1; anchorY += 0.5) {\n      top = y - anchorY * selfHeight;\n      bottom = top + selfHeight;\n      cutoffY = Math.max(0, padding - top) + Math.max(0, bottom - height + padding);\n      if (cutoffY < minCutoff) {\n        minCutoff = cutoffY;\n        bestAnchorY = anchorY;\n      }\n    }\n    anchorY = bestAnchorY;\n  }\n\n  // If needed, adjust anchorX at 0.5 step between [0, 1]\n  let xStep = 0.5;\n  if (anchorY === 0.5) {\n    // If y is centered, then x cannot also be centered\n    anchorX = Math.floor(anchorX);\n    xStep = 1;\n  }\n\n  // anchorX: left - 0, center - 0.5, right - 1\n  let left = x - anchorX * selfWidth;\n  let right = left + selfWidth;\n  let cutoffX = Math.max(0, padding - left) + Math.max(0, right - width + padding);\n\n  if (cutoffX > 0) {\n    // Needs horizontal adjustment\n    let bestAnchorX = anchorX;\n    let minCutoff = cutoffX;\n    // Test anchorX at xStep between [0, 1]\n    for (anchorX = 0; anchorX <= 1; anchorX += xStep) {\n      left = x - anchorX * selfWidth;\n      right = left + selfWidth;\n      cutoffX = Math.max(0, padding - left) + Math.max(0, right - width + padding);\n      if (cutoffX < minCutoff) {\n        minCutoff = cutoffX;\n        bestAnchorX = anchorX;\n      }\n    }\n    anchorX = bestAnchorX;\n  }\n\n  // Find the name of the new anchor position\n  return (\n    ANCHOR_TYPES.find(positionType => {\n      const anchorPosition = ANCHOR_POSITION[positionType];\n      return anchorPosition.x === anchorX && anchorPosition.y === anchorY;\n    }) || anchor\n  );\n}\n"],"mappings":"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"}