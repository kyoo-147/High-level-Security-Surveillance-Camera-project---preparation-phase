{"version":3,"file":"canvas-overlay.js","names":["React","useState","useEffect","PropTypes","useMapControl","mapControlPropTypes","pixelRatio","window","devicePixelRatio","propTypes","Object","assign","redraw","func","isRequired","defaultProps","captureScroll","captureDrag","captureClick","captureDoubleClick","capturePointerMove","CanvasOverlay","props","context","containerRef","ctx","setDrawingContext","current","getContext","viewport","isDragging","save","scale","width","height","project","unproject","restore","position","left","top"],"sources":["../../../src/overlays/canvas-overlay.js"],"sourcesContent":["// Copyright (c) 2015 Uber Technologies, Inc.\n\n// Permission is hereby granted, free of charge, to any person obtaining a copy\n// of this software and associated documentation files (the \"Software\"), to deal\n// in the Software without restriction, including without limitation the rights\n// to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n// copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n\n// The above copyright notice and this permission notice shall be included in\n// all copies or substantial portions of the Software.\n\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n// IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n// FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n// AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n// LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\n// THE SOFTWARE.\n\nimport * as React from 'react';\nimport {useState, useEffect} from 'react';\nimport * as PropTypes from 'prop-types';\nimport useMapControl, {mapControlPropTypes} from '../components/use-map-control';\n\n/* global window */\nconst pixelRatio = (typeof window !== 'undefined' && window.devicePixelRatio) || 1;\n\nconst propTypes = Object.assign({}, mapControlPropTypes, {\n  redraw: PropTypes.func.isRequired\n});\n\nconst defaultProps = {\n  captureScroll: false,\n  captureDrag: false,\n  captureClick: false,\n  captureDoubleClick: false,\n  capturePointerMove: false\n};\n\nfunction CanvasOverlay(props) {\n  const {context, containerRef} = useMapControl(props);\n  const [ctx, setDrawingContext] = useState(null);\n\n  useEffect(() => {\n    setDrawingContext(containerRef.current.getContext('2d'));\n  }, []);\n\n  const {viewport, isDragging} = context;\n\n  if (ctx) {\n    ctx.save();\n    ctx.scale(pixelRatio, pixelRatio);\n\n    props.redraw({\n      width: viewport.width,\n      height: viewport.height,\n      ctx,\n      isDragging,\n      project: viewport.project,\n      unproject: viewport.unproject\n    });\n\n    ctx.restore();\n  }\n\n  return (\n    <canvas\n      ref={containerRef}\n      width={viewport.width * pixelRatio}\n      height={viewport.height * pixelRatio}\n      style={{\n        width: `${viewport.width}px`,\n        height: `${viewport.height}px`,\n        position: 'absolute',\n        left: 0,\n        top: 0\n      }}\n    />\n  );\n}\n\nCanvasOverlay.propTypes = propTypes;\nCanvasOverlay.defaultProps = defaultProps;\n\nexport default CanvasOverlay;\n"],"mappings":";AAoBA,OAAO,KAAKA,KAAK,MAAM,OAAO;AAC9B,SAAQC,QAAQ,EAAEC,SAAS,QAAO,OAAO;AACzC,OAAO,KAAKC,SAAS,MAAM,YAAY;AACvC,OAAOC,aAAa,IAAGC,mBAAmB,QAAO,+BAA+B;AAGhF,IAAMC,UAAU,GAAI,OAAOC,MAAM,KAAK,WAAW,IAAIA,MAAM,CAACC,gBAAgB,IAAK,CAAC;AAElF,IAAMC,SAAS,GAAGC,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,EAAEN,mBAAmB,EAAE;EACvDO,MAAM,EAAET,SAAS,CAACU,IAAI,CAACC;AACzB,CAAC,CAAC;AAEF,IAAMC,YAAY,GAAG;EACnBC,aAAa,EAAE,KAAK;EACpBC,WAAW,EAAE,KAAK;EAClBC,YAAY,EAAE,KAAK;EACnBC,kBAAkB,EAAE,KAAK;EACzBC,kBAAkB,EAAE;AACtB,CAAC;AAED,SAASC,aAAa,CAACC,KAAK,EAAE;EAC5B,qBAAgClB,aAAa,CAACkB,KAAK,CAAC;IAA7CC,OAAO,kBAAPA,OAAO;IAAEC,YAAY,kBAAZA,YAAY;EAC5B,gBAAiCvB,QAAQ,CAAC,IAAI,CAAC;IAAA;IAAxCwB,GAAG;IAAEC,iBAAiB;EAE7BxB,SAAS,CAAC,YAAM;IACdwB,iBAAiB,CAACF,YAAY,CAACG,OAAO,CAACC,UAAU,CAAC,IAAI,CAAC,CAAC;EAC1D,CAAC,EAAE,EAAE,CAAC;EAEN,IAAOC,QAAQ,GAAgBN,OAAO,CAA/BM,QAAQ;IAAEC,UAAU,GAAIP,OAAO,CAArBO,UAAU;EAE3B,IAAIL,GAAG,EAAE;IACPA,GAAG,CAACM,IAAI,EAAE;IACVN,GAAG,CAACO,KAAK,CAAC1B,UAAU,EAAEA,UAAU,CAAC;IAEjCgB,KAAK,CAACV,MAAM,CAAC;MACXqB,KAAK,EAAEJ,QAAQ,CAACI,KAAK;MACrBC,MAAM,EAAEL,QAAQ,CAACK,MAAM;MACvBT,GAAG,EAAHA,GAAG;MACHK,UAAU,EAAVA,UAAU;MACVK,OAAO,EAAEN,QAAQ,CAACM,OAAO;MACzBC,SAAS,EAAEP,QAAQ,CAACO;IACtB,CAAC,CAAC;IAEFX,GAAG,CAACY,OAAO,EAAE;EACf;EAEA,OACE;IACE,GAAG,EAAEb,YAAa;IAClB,KAAK,EAAEK,QAAQ,CAACI,KAAK,GAAG3B,UAAW;IACnC,MAAM,EAAEuB,QAAQ,CAACK,MAAM,GAAG5B,UAAW;IACrC,KAAK,EAAE;MACL2B,KAAK,YAAKJ,QAAQ,CAACI,KAAK,OAAI;MAC5BC,MAAM,YAAKL,QAAQ,CAACK,MAAM,OAAI;MAC9BI,QAAQ,EAAE,UAAU;MACpBC,IAAI,EAAE,CAAC;MACPC,GAAG,EAAE;IACP;EAAE,EACF;AAEN;AAEAnB,aAAa,CAACZ,SAAS,GAAGA,SAAS;AACnCY,aAAa,CAACN,YAAY,GAAGA,YAAY;AAEzC,eAAeM,aAAa"}