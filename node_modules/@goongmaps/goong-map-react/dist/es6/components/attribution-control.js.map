{"version":3,"file":"attribution-control.js","names":["React","useEffect","useCallback","useState","useRef","useMemo","PropTypes","mapboxgl","useMapControl","mapControlDefaultProps","mapControlPropTypes","propTypes","Object","assign","toggleLabel","string","className","style","object","compact","bool","customAttribution","oneOfType","arrayOf","defaultProps","setupAttributioncontrol","opts","map","container","attributionContainer","control","AttributionControl","_map","_container","_innerContainer","_updateAttributions","_updateEditLink","on","_updateData","removeAttributionControl","off","props","context","containerRef","innerContainerRef","showCompact","setShowCompact","current","undefined","viewport","width","toggleAttribution","value","position","memo"],"sources":["../../../src/components/attribution-control.js"],"sourcesContent":["import * as React from 'react';\nimport {useEffect, useCallback, useState, useRef, useMemo} from 'react';\nimport * as PropTypes from 'prop-types';\nimport mapboxgl from '../utils/goongmap';\nimport useMapControl, {mapControlDefaultProps, mapControlPropTypes} from './use-map-control';\n\nconst propTypes = Object.assign({}, mapControlPropTypes, {\n  toggleLabel: PropTypes.string,\n  className: PropTypes.string,\n  style: PropTypes.object,\n  compact: PropTypes.bool,\n  customAttribution: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string)])\n});\n\nconst defaultProps = Object.assign({}, mapControlDefaultProps, {\n  className: '',\n  toggleLabel: 'Toggle Attribution'\n});\n\nfunction setupAttributioncontrol(opts, map, container, attributionContainer) {\n  const control = new mapboxgl.AttributionControl(opts);\n  control._map = map;\n  control._container = container;\n  control._innerContainer = attributionContainer;\n\n  // from AttributionControl.onAdd()\n  control._updateAttributions();\n  control._updateEditLink();\n  map.on('styledata', control._updateData);\n  map.on('sourcedata', control._updateData);\n\n  return control;\n}\n\nfunction removeAttributionControl(control) {\n  control._map.off('styledata', control._updateData);\n  control._map.off('sourcedata', control._updateData);\n}\n\nfunction AttributionControl(props) {\n  const {context, containerRef} = useMapControl(props);\n  const innerContainerRef = useRef(null);\n  const [showCompact, setShowCompact] = useState(false);\n\n  useEffect(() => {\n    let control;\n    if (context.map) {\n      control = setupAttributioncontrol(\n        {\n          customAttribution: props.customAttribution\n        },\n        context.map,\n        containerRef.current,\n        innerContainerRef.current\n      );\n    }\n\n    return () => control && removeAttributionControl(control);\n  }, [context.map]);\n\n  const compact = props.compact === undefined ? context.viewport.width <= 640 : props.compact;\n\n  useEffect(() => {\n    if (!compact && showCompact) {\n      setShowCompact(false);\n    }\n  }, [compact]);\n\n  const toggleAttribution = useCallback(() => setShowCompact(value => !value), []);\n  const style = useMemo(() => ({position: 'absolute', ...props.style}), [props.style]);\n\n  return (\n    <div style={style} className={props.className}>\n      <div\n        ref={containerRef}\n        aria-pressed={showCompact}\n        className={`mapboxgl-ctrl mapboxgl-ctrl-attrib ${compact ? 'mapboxgl-compact' : ''} ${\n          showCompact ? 'mapboxgl-compact-show' : ''\n        }`}\n      >\n        <button\n          type=\"button\"\n          className=\"mapboxgl-ctrl-attrib-button\"\n          title={props.toggleLabel}\n          onClick={toggleAttribution}\n        />\n        <div ref={innerContainerRef} className=\"mapboxgl-ctrl-attrib-inner\" role=\"list\" />\n      </div>\n    </div>\n  );\n}\n\nAttributionControl.propTypes = propTypes;\nAttributionControl.defaultProps = defaultProps;\n\nexport default React.memo(AttributionControl);\n"],"mappings":"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"}