{"version":3,"file":"attribution-control.js","names":["propTypes","Object","assign","mapControlPropTypes","toggleLabel","PropTypes","string","className","style","object","compact","bool","customAttribution","oneOfType","arrayOf","defaultProps","mapControlDefaultProps","setupAttributioncontrol","opts","map","container","attributionContainer","control","mapboxgl","AttributionControl","_map","_container","_innerContainer","_updateAttributions","_updateEditLink","on","_updateData","removeAttributionControl","off","props","useMapControl","context","containerRef","innerContainerRef","useRef","useState","showCompact","setShowCompact","useEffect","current","undefined","viewport","width","toggleAttribution","useCallback","value","useMemo","position","React","memo"],"sources":["../../../src/components/attribution-control.js"],"sourcesContent":["import * as React from 'react';\nimport {useEffect, useCallback, useState, useRef, useMemo} from 'react';\nimport * as PropTypes from 'prop-types';\nimport mapboxgl from '../utils/goongmap';\nimport useMapControl, {mapControlDefaultProps, mapControlPropTypes} from './use-map-control';\n\nconst propTypes = Object.assign({}, mapControlPropTypes, {\n  toggleLabel: PropTypes.string,\n  className: PropTypes.string,\n  style: PropTypes.object,\n  compact: PropTypes.bool,\n  customAttribution: PropTypes.oneOfType([PropTypes.string, PropTypes.arrayOf(PropTypes.string)])\n});\n\nconst defaultProps = Object.assign({}, mapControlDefaultProps, {\n  className: '',\n  toggleLabel: 'Toggle Attribution'\n});\n\nfunction setupAttributioncontrol(opts, map, container, attributionContainer) {\n  const control = new mapboxgl.AttributionControl(opts);\n  control._map = map;\n  control._container = container;\n  control._innerContainer = attributionContainer;\n\n  // from AttributionControl.onAdd()\n  control._updateAttributions();\n  control._updateEditLink();\n  map.on('styledata', control._updateData);\n  map.on('sourcedata', control._updateData);\n\n  return control;\n}\n\nfunction removeAttributionControl(control) {\n  control._map.off('styledata', control._updateData);\n  control._map.off('sourcedata', control._updateData);\n}\n\nfunction AttributionControl(props) {\n  const {context, containerRef} = useMapControl(props);\n  const innerContainerRef = useRef(null);\n  const [showCompact, setShowCompact] = useState(false);\n\n  useEffect(() => {\n    let control;\n    if (context.map) {\n      control = setupAttributioncontrol(\n        {\n          customAttribution: props.customAttribution\n        },\n        context.map,\n        containerRef.current,\n        innerContainerRef.current\n      );\n    }\n\n    return () => control && removeAttributionControl(control);\n  }, [context.map]);\n\n  const compact = props.compact === undefined ? context.viewport.width <= 640 : props.compact;\n\n  useEffect(() => {\n    if (!compact && showCompact) {\n      setShowCompact(false);\n    }\n  }, [compact]);\n\n  const toggleAttribution = useCallback(() => setShowCompact(value => !value), []);\n  const style = useMemo(() => ({position: 'absolute', ...props.style}), [props.style]);\n\n  return (\n    <div style={style} className={props.className}>\n      <div\n        ref={containerRef}\n        aria-pressed={showCompact}\n        className={`mapboxgl-ctrl mapboxgl-ctrl-attrib ${compact ? 'mapboxgl-compact' : ''} ${\n          showCompact ? 'mapboxgl-compact-show' : ''\n        }`}\n      >\n        <button\n          type=\"button\"\n          className=\"mapboxgl-ctrl-attrib-button\"\n          title={props.toggleLabel}\n          onClick={toggleAttribution}\n        />\n        <div ref={innerContainerRef} className=\"mapboxgl-ctrl-attrib-inner\" role=\"list\" />\n      </div>\n    </div>\n  );\n}\n\nAttributionControl.propTypes = propTypes;\nAttributionControl.defaultProps = defaultProps;\n\nexport default React.memo(AttributionControl);\n"],"mappings":"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"}